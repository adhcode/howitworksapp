{"version":3,"sources":["../../src/email/email.service.ts"],"sourcesContent":["import { Injectable, Logger } from '@nestjs/common';\nimport { Resend } from 'resend';\nimport { ConfigService } from '@nestjs/config';\n\n@Injectable()\nexport class EmailService {\n  private readonly logger = new Logger(EmailService.name);\n  private resend: Resend;\n\n  constructor(private configService: ConfigService) {\n    this.initializeResend();\n  }\n\n  private initializeResend() {\n    const resendApiKey = this.configService.get<string>('RESEND_API_KEY');\n\n    if (!resendApiKey) {\n      this.logger.warn('RESEND_API_KEY not found. Email functionality will be disabled.');\n      return;\n    }\n\n    this.resend = new Resend(resendApiKey);\n  }\n\n  async sendVerificationEmail(email: string, firstName: string, token: string): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    const verificationUrl = `${this.configService.get('FRONTEND_URL', 'http://localhost:8081')}/auth/verify-email?token=${token}`;\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HIW Maintenance <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: 'Verify Your Email Address - HIW Maintenance',\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Verify Your Email - HIW Maintenance</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header with Navy Blue Background -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" width=\"60\" height=\"60\" version=\"1.1\" style=\"shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd; margin-bottom: 16px;\" viewBox=\"0 0 230.92 231.07\">\n                          <path fill=\"#ffffff\" d=\"M-0 105.78l0 73.91c0,16.55 6.15,30.55 16.65,39.71 1.62,-0.14 3.29,-0.26 4.65,-0.88 4.84,-0.85 9.64,-4.42 12.07,-6.9 7.09,-7.22 10.19,-17.26 7.05,-27.17 -1.05,-3.3 -4.36,-10.17 -6.93,-11.49 -0.06,-0.56 0.32,-0.44 -0.36,-0.96 -0.5,-3.11 0.1,-3.98 1.68,-5.71l7.4 -7.51c2.94,-2.91 5.7,-6.46 8.85,-5.36 2.55,0.9 11.85,11.87 28.49,6.83 3.98,-1.21 6.93,-3.2 9.46,-5.45 4.67,-4.16 9.04,-10.87 9.61,-20.16 0.4,-6.49 3.79,-5.71 9.61,-5.7 2.94,0 12.46,-0.44 14.47,0.48 3.31,1.52 2.59,6.58 4.02,10.9 2.24,6.74 7.46,12.65 14.02,15.82 3.59,1.73 7.74,2.81 12.25,2.71 12.93,-0.27 18.01,-7.88 20.68,-9.21 2.23,-1.11 4.04,-0.27 5.44,1.12l7.72 7.2c1.23,1.33 2.42,2.08 3.87,3.59 2.63,2.75 6.98,4.97 6.11,8.62 -0.74,3.09 -14.4,14.08 -4.86,33.46 2.86,5.82 9,11.13 16.44,13.39 2.34,0.71 5.04,0.72 7.29,1.12 9.64,-9.16 15.25,-22.64 15.25,-38.45l0 -73.91c0,-14.8 -3.56,-25.44 -12.24,-35.78 -3.79,-4.51 -5.62,-5.73 -10.73,-9.77l-53.18 -43.94c-2.57,-2.09 -4.79,-4.1 -7.48,-6.01 -8.51,-6.03 -21.31,-10.29 -31.83,-10.29l-11.99 1.53c-3.92,0.9 -7.16,1.98 -10.49,3.53 -7.36,3.43 -10.74,6.11 -16.53,10.99 -8.76,7.38 -22.51,18.05 -30.45,25.12l-15.08 12.44c-2.67,2.15 -4.74,3.94 -7.35,6.14 -2.65,2.23 -4.96,4.22 -7.7,6.33 -4.19,3.22 -9.09,11.23 -11.38,16.14 -3.04,6.52 -4.49,14.23 -4.49,23.56zm152.12 -20.44l-16.85 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.86c0,2.7 2.21,4.92 4.92,4.92l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -17.86c0,-2.7 -2.21,-4.92 -4.92,-4.92zm-64.32 -0.71l-15.52 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.86c0,2.71 2.21,4.92 4.92,4.92l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -16.98c1.05,-4.22 3.72,-9.28 8.51,-11.36 0.31,0.06 0.63,0.09 0.96,0.09l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -17.86c0,-2.71 -2.21,-4.92 -4.92,-4.92l-16.85 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.27c-1.07,4.46 -5.87,9.3 -10.79,10.98l0 0zm-27.27 146.41l0.03 0c-0.02,-0.28 -0.02,-0.2 -0.03,0zm0.12 0c36.93,0.18 72.28,-0.46 109.68,-0.19 -1.19,-15.6 -9.04,-30.47 -22.03,-40.09 -35.62,-26.38 -84.89,-2.31 -87.65,40.28z\"/>\n                        </svg>\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HIW Maintenance\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\">\n                          Welcome, ${firstName}! üëã\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 20px 0; font-size: 16px;\">\n                          Thank you for joining HIW Maintenance! We're excited to have you on board.\n                        </p>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px;\">\n                          To complete your registration and secure your account, please verify your email address by clicking the button below:\n                        </p>\n                        \n                        <!-- CTA Button -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <a href=\"${verificationUrl}\" \n                                 style=\"display: inline-block; background-color: #1A2A52; color: #ffffff; \n                                        padding: 16px 40px; text-decoration: none; border-radius: 8px; \n                                        font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px rgba(26, 42, 82, 0.2);\">\n                                Verify Email Address\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Alternative Link -->\n                        <div style=\"background-color: #f9fafb; border-left: 4px solid #1A2A52; padding: 16px; border-radius: 4px; margin: 0 0 30px 0;\">\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0; font-weight: 600;\">\n                            Button not working?\n                          </p>\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0; line-height: 1.5;\">\n                            Copy and paste this link into your browser:\n                          </p>\n                          <p style=\"margin: 8px 0 0 0;\">\n                            <a href=\"${verificationUrl}\" style=\"color: #1A2A52; word-break: break-all; font-size: 13px;\">\n                              ${verificationUrl}\n                            </a>\n                          </p>\n                        </div>\n                        \n                        <!-- Security Note -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px;\">\n                          <p style=\"color: #9ca3af; font-size: 13px; line-height: 1.5; margin: 0;\">\n                            <strong>Security Note:</strong> This verification link will expire in 24 hours. \n                            If you didn't create an account with HIW Maintenance, you can safely ignore this email.\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send verification email: ${error.message}`);\n      }\n\n      this.logger.log(`Verification email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send verification email to ${email}:`, error);\n      throw error;\n    }\n  }\n\n  async sendVerificationCodeEmail(email: string, firstName: string, code: string): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HIW Maintenance <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: 'Verify Your Email Address - HIW Maintenance',\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Verify Your Email - HIW Maintenance</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header with Navy Blue Background -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" width=\"60\" height=\"60\" version=\"1.1\" style=\"shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd; margin-bottom: 16px;\" viewBox=\"0 0 230.92 231.07\">\n                          <path fill=\"#ffffff\" d=\"M-0 105.78l0 73.91c0,16.55 6.15,30.55 16.65,39.71 1.62,-0.14 3.29,-0.26 4.65,-0.88 4.84,-0.85 9.64,-4.42 12.07,-6.9 7.09,-7.22 10.19,-17.26 7.05,-27.17 -1.05,-3.3 -4.36,-10.17 -6.93,-11.49 -0.06,-0.56 0.32,-0.44 -0.36,-0.96 -0.5,-3.11 0.1,-3.98 1.68,-5.71l7.4 -7.51c2.94,-2.91 5.7,-6.46 8.85,-5.36 2.55,0.9 11.85,11.87 28.49,6.83 3.98,-1.21 6.93,-3.2 9.46,-5.45 4.67,-4.16 9.04,-10.87 9.61,-20.16 0.4,-6.49 3.79,-5.71 9.61,-5.7 2.94,0 12.46,-0.44 14.47,0.48 3.31,1.52 2.59,6.58 4.02,10.9 2.24,6.74 7.46,12.65 14.02,15.82 3.59,1.73 7.74,2.81 12.25,2.71 12.93,-0.27 18.01,-7.88 20.68,-9.21 2.23,-1.11 4.04,-0.27 5.44,1.12l7.72 7.2c1.23,1.33 2.42,2.08 3.87,3.59 2.63,2.75 6.98,4.97 6.11,8.62 -0.74,3.09 -14.4,14.08 -4.86,33.46 2.86,5.82 9,11.13 16.44,13.39 2.34,0.71 5.04,0.72 7.29,1.12 9.64,-9.16 15.25,-22.64 15.25,-38.45l0 -73.91c0,-14.8 -3.56,-25.44 -12.24,-35.78 -3.79,-4.51 -5.62,-5.73 -10.73,-9.77l-53.18 -43.94c-2.57,-2.09 -4.79,-4.1 -7.48,-6.01 -8.51,-6.03 -21.31,-10.29 -31.83,-10.29l-11.99 1.53c-3.92,0.9 -7.16,1.98 -10.49,3.53 -7.36,3.43 -10.74,6.11 -16.53,10.99 -8.76,7.38 -22.51,18.05 -30.45,25.12l-15.08 12.44c-2.67,2.15 -4.74,3.94 -7.35,6.14 -2.65,2.23 -4.96,4.22 -7.7,6.33 -4.19,3.22 -9.09,11.23 -11.38,16.14 -3.04,6.52 -4.49,14.23 -4.49,23.56zm152.12 -20.44l-16.85 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.86c0,2.7 2.21,4.92 4.92,4.92l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -17.86c0,-2.7 -2.21,-4.92 -4.92,-4.92zm-64.32 -0.71l-15.52 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.86c0,2.71 2.21,4.92 4.92,4.92l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -16.98c1.05,-4.22 3.72,-9.28 8.51,-11.36 0.31,0.06 0.63,0.09 0.96,0.09l16.85 0c2.71,0 4.92,-2.21 4.92,-4.92l0 -17.86c0,-2.71 -2.21,-4.92 -4.92,-4.92l-16.85 0c-2.71,0 -4.92,2.21 -4.92,4.92l0 17.27c-1.07,4.46 -5.87,9.3 -10.79,10.98l0 0zm-27.27 146.41l0.03 0c-0.02,-0.28 -0.02,-0.2 -0.03,0zm0.12 0c36.93,0.18 72.28,-0.46 109.68,-0.19 -1.19,-15.6 -9.04,-30.47 -22.03,-40.09 -35.62,-26.38 -84.89,-2.31 -87.65,40.28z\"/>\n                        </svg>\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HIW Maintenance\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\">\n                          Welcome, ${firstName}! üëã\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 20px 0; font-size: 16px;\">\n                          Thank you for joining HIW Maintenance! We're excited to have you on board.\n                        </p>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px;\">\n                          To complete your registration and secure your account, please enter the verification code below in the app:\n                        </p>\n                        \n                        <!-- Verification Code -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <div style=\"background-color: #f9fafb; border: 2px dashed #1A2A52; border-radius: 12px; padding: 24px; display: inline-block;\">\n                                <p style=\"color: #6b7280; font-size: 14px; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">\n                                  Your Verification Code\n                                </p>\n                                <p style=\"color: #1A2A52; font-size: 36px; font-weight: 700; margin: 0; letter-spacing: 8px; font-family: 'Courier New', monospace;\">\n                                  ${code}\n                                </p>\n                              </div>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Instructions -->\n                        <div style=\"background-color: #f9fafb; border-left: 4px solid #1A2A52; padding: 16px; border-radius: 4px; margin: 0 0 30px 0;\">\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0; font-weight: 600;\">\n                            How to verify:\n                          </p>\n                          <ol style=\"color: #6b7280; font-size: 13px; margin: 0; padding-left: 20px; line-height: 1.8;\">\n                            <li>Open the HIW Maintenance app</li>\n                            <li>Enter the 6-digit code above</li>\n                            <li>Click \"Verify\" to complete your registration</li>\n                          </ol>\n                        </div>\n                        \n                        <!-- Security Note -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px;\">\n                          <p style=\"color: #9ca3af; font-size: 13px; line-height: 1.5; margin: 0;\">\n                            <strong>Security Note:</strong> This verification code will expire in 15 minutes. \n                            If you didn't create an account with HIW Maintenance, you can safely ignore this email.\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send verification email: ${error.message}`);\n      }\n\n      this.logger.log(`Verification code email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send verification code email to ${email}:`, error);\n      throw error;\n    }\n  }\n\n  async sendWelcomeEmail(email: string, firstName: string): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HowitWorks <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: 'Welcome to HowitWorks! üéâ',\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Welcome to HowitWorks</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header with Navy Blue Background -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HowitWorks\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Property Management Made Simple\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <div style=\"text-align: center; margin-bottom: 30px;\">\n                          <span style=\"font-size: 48px;\">üéâ</span>\n                        </div>\n                        \n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600; text-align: center;\">\n                          Welcome to HowitWorks, ${firstName}!\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px; text-align: center;\">\n                          Your email has been verified successfully! You're all set to start managing your properties.\n                        </p>\n                        \n                        <!-- Features -->\n                        <div style=\"background-color: #f9fafb; border-radius: 8px; padding: 24px; margin: 0 0 30px 0;\">\n                          <h3 style=\"color: #1A2A52; margin: 0 0 16px 0; font-size: 18px; font-weight: 600;\">\n                            What you can do now:\n                          </h3>\n                          \n                          <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                            <tr>\n                              <td style=\"padding: 8px 0;\">\n                                <span style=\"color: #1A2A52; font-size: 18px; margin-right: 12px;\">‚úì</span>\n                                <span style=\"color: #4b5563; font-size: 15px;\">Manage your properties and tenants</span>\n                              </td>\n                            </tr>\n                            <tr>\n                              <td style=\"padding: 8px 0;\">\n                                <span style=\"color: #1A2A52; font-size: 18px; margin-right: 12px;\">‚úì</span>\n                                <span style=\"color: #4b5563; font-size: 15px;\">Track maintenance requests</span>\n                              </td>\n                            </tr>\n                            <tr>\n                              <td style=\"padding: 8px 0;\">\n                                <span style=\"color: #1A2A52; font-size: 18px; margin-right: 12px;\">‚úì</span>\n                                <span style=\"color: #4b5563; font-size: 15px;\">Handle payments seamlessly</span>\n                              </td>\n                            </tr>\n                            <tr>\n                              <td style=\"padding: 8px 0;\">\n                                <span style=\"color: #1A2A52; font-size: 18px; margin-right: 12px;\">‚úì</span>\n                                <span style=\"color: #4b5563; font-size: 15px;\">Communicate with ease</span>\n                              </td>\n                            </tr>\n                          </table>\n                        </div>\n                        \n                        <!-- CTA Button -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <a href=\"${this.configService.get('FRONTEND_URL', 'http://localhost:8081')}\" \n                                 style=\"display: inline-block; background-color: #1A2A52; color: #ffffff; \n                                        padding: 16px 40px; text-decoration: none; border-radius: 8px; \n                                        font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px rgba(26, 42, 82, 0.2);\">\n                                Get Started Now\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Support -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px; text-align: center;\">\n                          <p style=\"color: #6b7280; font-size: 14px; margin: 0;\">\n                            Need help? We're here for you!\n                          </p>\n                          <p style=\"color: #9ca3af; font-size: 13px; margin: 8px 0 0 0;\">\n                            Contact our support team anytime\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send welcome email: ${error.message}`);\n      }\n\n      this.logger.log(`Welcome email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send welcome email to ${email}:`, error);\n    }\n  }\n\n  async sendPaymentReminderEmail(\n    email: string,\n    firstName: string,\n    title: string,\n    message: string,\n    amount?: number,\n    dueDate?: string,\n  ): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HowitWorks <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: title,\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>${title}</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HowitWorks\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Property Management Made Simple\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\">\n                          ${title}\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 16px 0; font-size: 16px;\">\n                          Hi ${firstName},\n                        </p>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px;\">\n                          ${message}\n                        </p>\n                        \n                        ${amount ? `\n                        <!-- Payment Details -->\n                        <div style=\"background-color: #f9fafb; border-radius: 8px; padding: 24px; margin: 0 0 30px 0;\">\n                          <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                            <tr>\n                              <td style=\"padding: 8px 0; color: #6b7280; font-size: 14px;\">Amount Due:</td>\n                              <td style=\"padding: 8px 0; color: #1A2A52; font-size: 18px; font-weight: 700; text-align: right;\">‚Ç¶${amount.toLocaleString()}</td>\n                            </tr>\n                            ${dueDate ? `\n                            <tr>\n                              <td style=\"padding: 8px 0; color: #6b7280; font-size: 14px;\">Due Date:</td>\n                              <td style=\"padding: 8px 0; color: #1A2A52; font-size: 16px; font-weight: 600; text-align: right;\">${new Date(dueDate).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</td>\n                            </tr>\n                            ` : ''}\n                          </table>\n                        </div>\n                        ` : ''}\n                        \n                        <!-- CTA Button -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <a href=\"${this.configService.get('FRONTEND_URL', 'http://localhost:8081')}\" \n                                 style=\"display: inline-block; background-color: #1A2A52; color: #ffffff; \n                                        padding: 16px 40px; text-decoration: none; border-radius: 8px; \n                                        font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px rgba(26, 42, 82, 0.2);\">\n                                Make Payment\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Support -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px;\">\n                          <p style=\"color: #9ca3af; font-size: 13px; line-height: 1.5; margin: 0;\">\n                            If you have any questions or need assistance, please contact our support team.\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send payment reminder email: ${error.message}`);\n      }\n\n      this.logger.log(`Payment reminder email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send payment reminder email to ${email}:`, error);\n      throw error;\n    }\n  }\n\n  async sendPasswordResetEmail(email: string, firstName: string, token: string): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    const resetUrl = `${this.configService.get('FRONTEND_URL', 'http://localhost:8081')}/auth/reset-password?token=${token}`;\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HowitWorks <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: 'Reset Your Password - HowitWorks',\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Reset Your Password - HowitWorks</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header with Navy Blue Background -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HowitWorks\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Property Management Made Simple\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <div style=\"text-align: center; margin-bottom: 30px;\">\n                          <span style=\"font-size: 48px;\">üîê</span>\n                        </div>\n                        \n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\">\n                          Reset Your Password\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 16px 0; font-size: 16px;\">\n                          Hi ${firstName},\n                        </p>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px;\">\n                          We received a request to reset your password. Click the button below to create a new password:\n                        </p>\n                        \n                        <!-- CTA Button -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <a href=\"${resetUrl}\" \n                                 style=\"display: inline-block; background-color: #1A2A52; color: #ffffff; \n                                        padding: 16px 40px; text-decoration: none; border-radius: 8px; \n                                        font-weight: 600; font-size: 16px; box-shadow: 0 4px 6px rgba(26, 42, 82, 0.2);\">\n                                Reset Password\n                              </a>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Alternative Link -->\n                        <div style=\"background-color: #f9fafb; border-left: 4px solid #1A2A52; padding: 16px; border-radius: 4px; margin: 0 0 30px 0;\">\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0; font-weight: 600;\">\n                            Button not working?\n                          </p>\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0; line-height: 1.5;\">\n                            Copy and paste this link into your browser:\n                          </p>\n                          <p style=\"margin: 8px 0 0 0;\">\n                            <a href=\"${resetUrl}\" style=\"color: #1A2A52; word-break: break-all; font-size: 13px;\">\n                              ${resetUrl}\n                            </a>\n                          </p>\n                        </div>\n                        \n                        <!-- Security Warning -->\n                        <div style=\"background-color: #fef3c7; border-left: 4px solid #f59e0b; padding: 16px; border-radius: 4px; margin: 0 0 20px 0;\">\n                          <p style=\"color: #92400e; font-size: 13px; margin: 0; line-height: 1.5;\">\n                            <strong>‚ö†Ô∏è Security Notice:</strong> This password reset link will expire in 1 hour. \n                            If you didn't request a password reset, please ignore this email and your password will remain unchanged.\n                          </p>\n                        </div>\n                        \n                        <!-- Support -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px;\">\n                          <p style=\"color: #9ca3af; font-size: 13px; line-height: 1.5; margin: 0;\">\n                            If you're having trouble or didn't request this reset, please contact our support team immediately.\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send password reset email: ${error.message}`);\n      }\n\n      this.logger.log(`Password reset email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send password reset email to ${email}:`, error);\n      throw error;\n    }\n  }\n\n  async sendPasswordResetCodeEmail(email: string, firstName: string, code: string): Promise<void> {\n    if (!this.resend) {\n      this.logger.warn('Resend not configured. Skipping email send.');\n      return;\n    }\n\n    try {\n      const { data, error } = await this.resend.emails.send({\n        from: this.configService.get('RESEND_FROM_EMAIL', 'HowitWorks <noreply@howitworks.com.ng>'),\n        to: [email],\n        subject: 'Reset Your Password - HowitWorks',\n        html: `\n          <!DOCTYPE html>\n          <html>\n          <head>\n            <meta charset=\"utf-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>Reset Your Password - HowitWorks</title>\n          </head>\n          <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\">\n            <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse; background-color: #f5f5f5;\">\n              <tr>\n                <td align=\"center\" style=\"padding: 40px 20px;\">\n                  <table role=\"presentation\" style=\"width: 100%; max-width: 600px; border-collapse: collapse; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\">\n                    \n                    <!-- Header with Navy Blue Background -->\n                    <tr>\n                      <td style=\"background: linear-gradient(135deg, #1A2A52 0%, #2d4575 100%); padding: 40px 30px; text-align: center;\">\n                        <h1 style=\"color: #ffffff; margin: 0; font-size: 28px; font-weight: 700; letter-spacing: -0.5px;\">\n                          HowitWorks\n                        </h1>\n                        <p style=\"color: #e0e7ff; margin: 8px 0 0 0; font-size: 14px; font-weight: 400;\">\n                          Property Management Made Simple\n                        </p>\n                      </td>\n                    </tr>\n                    \n                    <!-- Content -->\n                    <tr>\n                      <td style=\"padding: 40px 30px;\">\n                        <div style=\"text-align: center; margin-bottom: 30px;\">\n                          <span style=\"font-size: 48px;\">üîê</span>\n                        </div>\n                        \n                        <h2 style=\"color: #1A2A52; margin: 0 0 20px 0; font-size: 24px; font-weight: 600;\">\n                          Reset Your Password\n                        </h2>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 16px 0; font-size: 16px;\">\n                          Hi ${firstName},\n                        </p>\n                        \n                        <p style=\"color: #4b5563; line-height: 1.6; margin: 0 0 30px 0; font-size: 16px;\">\n                          We received a request to reset your password. Enter the verification code below in the app to create a new password:\n                        </p>\n                        \n                        <!-- Verification Code -->\n                        <table role=\"presentation\" style=\"width: 100%; border-collapse: collapse;\">\n                          <tr>\n                            <td align=\"center\" style=\"padding: 0 0 30px 0;\">\n                              <div style=\"background-color: #f9fafb; border: 2px dashed #1A2A52; border-radius: 12px; padding: 24px; display: inline-block;\">\n                                <p style=\"color: #6b7280; font-size: 14px; margin: 0 0 8px 0; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">\n                                  Your Reset Code\n                                </p>\n                                <p style=\"color: #1A2A52; font-size: 36px; font-weight: 700; margin: 0; letter-spacing: 8px; font-family: 'Courier New', monospace;\">\n                                  ${code}\n                                </p>\n                              </div>\n                            </td>\n                          </tr>\n                        </table>\n                        \n                        <!-- Instructions -->\n                        <div style=\"background-color: #f9fafb; border-left: 4px solid #1A2A52; padding: 16px; border-radius: 4px; margin: 0 0 30px 0;\">\n                          <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0; font-weight: 600;\">\n                            How to reset your password:\n                          </p>\n                          <ol style=\"color: #6b7280; font-size: 13px; margin: 0; padding-left: 20px; line-height: 1.8;\">\n                            <li>Open the HowitWorks app</li>\n                            <li>Enter the 6-digit code above</li>\n                            <li>Create your new password</li>\n                          </ol>\n                        </div>\n                        \n                        <!-- Security Warning -->\n                        <div style=\"background-color: #fef3c7; border-left: 4px solid #f59e0b; padding: 16px; border-radius: 4px; margin: 0 0 20px 0;\">\n                          <p style=\"color: #92400e; font-size: 13px; margin: 0; line-height: 1.5;\">\n                            <strong>‚ö†Ô∏è Security Notice:</strong> This code will expire in 15 minutes. \n                            If you didn't request a password reset, please ignore this email and your password will remain unchanged.\n                          </p>\n                        </div>\n                        \n                        <!-- Support -->\n                        <div style=\"border-top: 1px solid #e5e7eb; padding-top: 20px;\">\n                          <p style=\"color: #9ca3af; font-size: 13px; line-height: 1.5; margin: 0;\">\n                            If you're having trouble or didn't request this reset, please contact our support team immediately.\n                          </p>\n                        </div>\n                      </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                      <td style=\"background-color: #f9fafb; padding: 30px; text-align: center; border-top: 1px solid #e5e7eb;\">\n                        <p style=\"color: #6b7280; font-size: 13px; margin: 0 0 8px 0;\">\n                          ¬© 2025 HowitWorks. All rights reserved.\n                        </p>\n                        <p style=\"color: #9ca3af; font-size: 12px; margin: 0;\">\n                          Smart Property Care\n                        </p>\n                      </td>\n                    </tr>\n                    \n                  </table>\n                </td>\n              </tr>\n            </table>\n          </body>\n          </html>\n        `,\n      });\n\n      if (error) {\n        this.logger.error(`Resend API error:`, error);\n        throw new Error(`Failed to send password reset code email: ${error.message}`);\n      }\n\n      this.logger.log(`Password reset code email sent to ${email}. Message ID: ${data?.id}`);\n    } catch (error) {\n      this.logger.error(`Failed to send password reset code email to ${email}:`, error);\n      throw error;\n    }\n  }\n}"],"names":["EmailService","initializeResend","resendApiKey","configService","get","logger","warn","resend","Resend","sendVerificationEmail","email","firstName","token","verificationUrl","data","error","emails","send","from","to","subject","html","Error","message","log","id","sendVerificationCodeEmail","code","sendWelcomeEmail","sendPaymentReminderEmail","title","amount","dueDate","toLocaleString","Date","toLocaleDateString","year","month","day","sendPasswordResetEmail","resetUrl","sendPasswordResetCodeEmail","Logger","name"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBALsB;wBACZ;wBACO;;;;;;;;;;AAGvB,IAAA,AAAMA,eAAN,MAAMA;IAQHC,mBAAmB;QACzB,MAAMC,eAAe,IAAI,CAACC,aAAa,CAACC,GAAG,CAAS;QAEpD,IAAI,CAACF,cAAc;YACjB,IAAI,CAACG,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,IAAI,CAACC,MAAM,GAAG,IAAIC,cAAM,CAACN;IAC3B;IAEA,MAAMO,sBAAsBC,KAAa,EAAEC,SAAiB,EAAEC,KAAa,EAAiB;QAC1F,IAAI,CAAC,IAAI,CAACL,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,MAAMO,kBAAkB,GAAG,IAAI,CAACV,aAAa,CAACC,GAAG,CAAC,gBAAgB,yBAAyB,yBAAyB,EAAEQ,OAAO;QAE7H,IAAI;YACF,MAAM,EAAEE,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAAS;gBACTC,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mCAiCoB,EAAEV,UAAU;;;;;;;;;;;;;;;uCAeR,EAAEE,gBAAgB;;;;;;;;;;;;;;;;;;;qCAmBpB,EAAEA,gBAAgB;8BACzB,EAAEA,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAiCxC,CAAC;YACH;YAEA,IAAIE,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,mCAAmC,EAAEP,MAAMQ,OAAO,EAAE;YACvE;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,2BAA2B,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QAChF,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,qCAAqC,EAAEL,MAAM,CAAC,CAAC,EAAEK;YACpE,MAAMA;QACR;IACF;IAEA,MAAMW,0BAA0BhB,KAAa,EAAEC,SAAiB,EAAEgB,IAAY,EAAiB;QAC7F,IAAI,CAAC,IAAI,CAACpB,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,IAAI;YACF,MAAM,EAAEQ,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAAS;gBACTC,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;mCAiCoB,EAAEV,UAAU;;;;;;;;;;;;;;;;;;;;kCAoBb,EAAEgB,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QA+CjC,CAAC;YACH;YAEA,IAAIZ,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,mCAAmC,EAAEP,MAAMQ,OAAO,EAAE;YACvE;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,gCAAgC,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QACrF,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,0CAA0C,EAAEL,MAAM,CAAC,CAAC,EAAEK;YACzE,MAAMA;QACR;IACF;IAEA,MAAMa,iBAAiBlB,KAAa,EAAEC,SAAiB,EAAiB;QACtE,IAAI,CAAC,IAAI,CAACJ,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,IAAI;YACF,MAAM,EAAEQ,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAAS;gBACTC,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;iDAkCkC,EAAEV,UAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;uCA6CtB,EAAE,IAAI,CAACR,aAAa,CAACC,GAAG,CAAC,gBAAgB,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAwCjG,CAAC;YACH;YAEA,IAAIW,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,8BAA8B,EAAEP,MAAMQ,OAAO,EAAE;YAClE;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,sBAAsB,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QAC3E,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,gCAAgC,EAAEL,MAAM,CAAC,CAAC,EAAEK;QACjE;IACF;IAEA,MAAMc,yBACJnB,KAAa,EACbC,SAAiB,EACjBmB,KAAa,EACbP,OAAe,EACfQ,MAAe,EACfC,OAAgB,EACD;QACf,IAAI,CAAC,IAAI,CAACzB,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,IAAI;YACF,MAAM,EAAEQ,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAASU;gBACTT,MAAM,CAAC;;;;;;mBAMI,EAAES,MAAM;;;;;;;;;;;;;;;;;;;;;;;;0BAwBD,EAAEA,MAAM;;;;6BAIL,EAAEnB,UAAU;;;;0BAIf,EAAEY,QAAQ;;;wBAGZ,EAAEQ,SAAS,CAAC;;;;;;iIAM6F,EAAEA,OAAOE,cAAc,GAAG;;4BAE/H,EAAED,UAAU,CAAC;;;gIAGuF,EAAE,IAAIE,KAAKF,SAASG,kBAAkB,CAAC,SAAS;oBAAEC,MAAM;oBAAWC,OAAO;oBAAQC,KAAK;gBAAU,GAAG;;4BAExM,CAAC,GAAG,GAAG;;;wBAGX,CAAC,GAAG,GAAG;;;;;;uCAMQ,EAAE,IAAI,CAACnC,aAAa,CAACC,GAAG,CAAC,gBAAgB,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAqCjG,CAAC;YACH;YAEA,IAAIW,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,uCAAuC,EAAEP,MAAMQ,OAAO,EAAE;YAC3E;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,+BAA+B,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QACpF,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,yCAAyC,EAAEL,MAAM,CAAC,CAAC,EAAEK;YACxE,MAAMA;QACR;IACF;IAEA,MAAMwB,uBAAuB7B,KAAa,EAAEC,SAAiB,EAAEC,KAAa,EAAiB;QAC3F,IAAI,CAAC,IAAI,CAACL,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,MAAMkC,WAAW,GAAG,IAAI,CAACrC,aAAa,CAACC,GAAG,CAAC,gBAAgB,yBAAyB,2BAA2B,EAAEQ,OAAO;QAExH,IAAI;YACF,MAAM,EAAEE,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAAS;gBACTC,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6BAsCc,EAAEV,UAAU;;;;;;;;;;;uCAWF,EAAE6B,SAAS;;;;;;;;;;;;;;;;;;;qCAmBb,EAAEA,SAAS;8BAClB,EAAEA,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAwCjC,CAAC;YACH;YAEA,IAAIzB,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,qCAAqC,EAAEP,MAAMQ,OAAO,EAAE;YACzE;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,6BAA6B,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QAClF,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,uCAAuC,EAAEL,MAAM,CAAC,CAAC,EAAEK;YACtE,MAAMA;QACR;IACF;IAEA,MAAM0B,2BAA2B/B,KAAa,EAAEC,SAAiB,EAAEgB,IAAY,EAAiB;QAC9F,IAAI,CAAC,IAAI,CAACpB,MAAM,EAAE;YAChB,IAAI,CAACF,MAAM,CAACC,IAAI,CAAC;YACjB;QACF;QAEA,IAAI;YACF,MAAM,EAAEQ,IAAI,EAAEC,KAAK,EAAE,GAAG,MAAM,IAAI,CAACR,MAAM,CAACS,MAAM,CAACC,IAAI,CAAC;gBACpDC,MAAM,IAAI,CAACf,aAAa,CAACC,GAAG,CAAC,qBAAqB;gBAClDe,IAAI;oBAACT;iBAAM;gBACXU,SAAS;gBACTC,MAAM,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6BAsCc,EAAEV,UAAU;;;;;;;;;;;;;;;;kCAgBP,EAAEgB,KAAK;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QAsDjC,CAAC;YACH;YAEA,IAAIZ,OAAO;gBACT,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAEA;gBACvC,MAAM,IAAIO,MAAM,CAAC,0CAA0C,EAAEP,MAAMQ,OAAO,EAAE;YAC9E;YAEA,IAAI,CAAClB,MAAM,CAACmB,GAAG,CAAC,CAAC,kCAAkC,EAAEd,MAAM,cAAc,EAAEI,MAAMW,IAAI;QACvF,EAAE,OAAOV,OAAO;YACd,IAAI,CAACV,MAAM,CAACU,KAAK,CAAC,CAAC,4CAA4C,EAAEL,MAAM,CAAC,CAAC,EAAEK;YAC3E,MAAMA;QACR;IACF;IAhzBA,YAAY,AAAQZ,aAA4B,CAAE;aAA9BA,gBAAAA;aAHHE,SAAS,IAAIqC,cAAM,CAAC1C,aAAa2C,IAAI;QAIpD,IAAI,CAAC1C,gBAAgB;IACvB;AA+yBF"}