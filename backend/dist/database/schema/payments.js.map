{"version":3,"sources":["../../../src/database/schema/payments.ts"],"sourcesContent":["import { pgTable, uuid, varchar, text, timestamp, decimal, boolean, pgEnum } from 'drizzle-orm/pg-core';\nimport { users } from './users';\nimport { properties, units } from './properties';\nimport { tenantInvitations } from './tenant-invitations';\n\nexport const paymentStatusEnum = pgEnum('payment_status', ['pending', 'paid', 'overdue', 'partial']);\nexport const paymentMethodEnum = pgEnum('payment_method', ['bank_transfer', 'cash', 'check', 'online', 'card']);\n\nexport const payments = pgTable('payments', {\n  id: uuid('id').defaultRandom().primaryKey(),\n  \n  // References\n  landlordId: uuid('landlord_id').references(() => users.id).notNull(),\n  tenantId: uuid('tenant_id').references(() => users.id).notNull(),\n  propertyId: uuid('property_id').references(() => properties.id).notNull(),\n  unitId: uuid('unit_id').references(() => units.id).notNull(),\n  tenantInvitationId: uuid('tenant_invitation_id').references(() => tenantInvitations.id),\n  \n  // Payment details\n  amount: decimal('amount', { precision: 10, scale: 2 }).notNull(),\n  amountPaid: decimal('amount_paid', { precision: 10, scale: 2 }).default('0.00'),\n  dueDate: timestamp('due_date').notNull(),\n  paidDate: timestamp('paid_date'),\n  \n  // Payment info\n  paymentType: varchar('payment_type', { length: 50 }).default('rent'), // rent, deposit, utilities, etc.\n  paymentMethod: paymentMethodEnum('payment_method'),\n  status: paymentStatusEnum('status').default('pending'),\n  \n  // Additional info\n  description: text('description'),\n  notes: text('notes'),\n  receiptNumber: varchar('receipt_number', { length: 100 }),\n  \n  // Payment gateway info\n  paystackReference: varchar('paystack_reference', { length: 255 }),\n  paystackStatus: varchar('paystack_status', { length: 50 }),\n  paymentGateway: varchar('payment_gateway', { length: 50 }).default('paystack'),\n  \n  // Tracking\n  createdAt: timestamp('created_at').defaultNow(),\n  updatedAt: timestamp('updated_at').defaultNow(),\n});\n\n// Payment history for tracking changes and audit trail\nexport const paymentHistory = pgTable('payment_history', {\n  id: uuid('id').defaultRandom().primaryKey(),\n  paymentId: uuid('payment_id').references(() => payments.id).notNull(),\n  \n  // What changed\n  action: varchar('action', { length: 50 }).notNull(), // created, updated, paid, overdue\n  previousStatus: paymentStatusEnum('previous_status'),\n  newStatus: paymentStatusEnum('new_status'),\n  \n  // Amount changes\n  previousAmount: decimal('previous_amount', { precision: 10, scale: 2 }),\n  newAmount: decimal('new_amount', { precision: 10, scale: 2 }),\n  \n  // Additional info\n  notes: text('notes'),\n  performedBy: uuid('performed_by').references(() => users.id),\n  \n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport type Payment = typeof payments.$inferSelect;\nexport type NewPayment = typeof payments.$inferInsert;\nexport type PaymentHistory = typeof paymentHistory.$inferSelect;\nexport type NewPaymentHistory = typeof paymentHistory.$inferInsert;"],"names":["paymentHistory","paymentMethodEnum","paymentStatusEnum","payments","pgEnum","pgTable","id","uuid","defaultRandom","primaryKey","landlordId","references","users","notNull","tenantId","propertyId","properties","unitId","units","tenantInvitationId","tenantInvitations","amount","decimal","precision","scale","amountPaid","default","dueDate","timestamp","paidDate","paymentType","varchar","length","paymentMethod","status","description","text","notes","receiptNumber","paystackReference","paystackStatus","paymentGateway","createdAt","defaultNow","updatedAt","paymentId","action","previousStatus","newStatus","previousAmount","newAmount","performedBy"],"mappings":"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"}