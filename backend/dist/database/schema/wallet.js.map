{"version":3,"sources":["../../../src/database/schema/wallet.ts"],"sourcesContent":["import { pgTable, uuid, varchar, decimal, timestamp, text, pgEnum } from 'drizzle-orm/pg-core';\nimport { users } from './users';\nimport { payments } from './payments';\n\n// Transaction types\nexport const transactionTypeEnum = pgEnum('transaction_type', [\n  'credit',\n  'debit',\n  'withdrawal',\n  'refund',\n  'fee',\n]);\n\n// Transaction status\nexport const transactionStatusEnum = pgEnum('transaction_status', [\n  'pending',\n  'completed',\n  'failed',\n  'cancelled',\n]);\n\n// Landlord wallet balances\nexport const landlordWalletBalances = pgTable('landlord_wallet_balances', {\n  id: uuid('id').defaultRandom().primaryKey(),\n  landlordId: uuid('landlord_id').references(() => users.id).notNull().unique(),\n  \n  // Balance tracking\n  availableBalance: decimal('available_balance', { precision: 12, scale: 2 }).default('0.00').notNull(),\n  pendingBalance: decimal('pending_balance', { precision: 12, scale: 2 }).default('0.00').notNull(),\n  totalEarned: decimal('total_earned', { precision: 12, scale: 2 }).default('0.00').notNull(),\n  totalWithdrawn: decimal('total_withdrawn', { precision: 12, scale: 2 }).default('0.00').notNull(),\n  \n  currency: varchar('currency', { length: 3 }).default('NGN').notNull(),\n  \n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n});\n\n// Wallet transactions\nexport const walletTransactions = pgTable('wallet_transactions', {\n  id: uuid('id').defaultRandom().primaryKey(),\n  landlordId: uuid('landlord_id').references(() => users.id).notNull(),\n  \n  // Transaction details\n  type: transactionTypeEnum('type').notNull(),\n  amount: decimal('amount', { precision: 12, scale: 2 }).notNull(),\n  balanceBefore: decimal('balance_before', { precision: 12, scale: 2 }).notNull(),\n  balanceAfter: decimal('balance_after', { precision: 12, scale: 2 }).notNull(),\n  \n  // References\n  reference: varchar('reference', { length: 255 }),\n  paymentId: uuid('payment_id').references(() => payments.id),\n  \n  // Status and metadata\n  status: transactionStatusEnum('status').default('completed').notNull(),\n  description: text('description'),\n  metadata: text('metadata'), // JSON string\n  \n  createdAt: timestamp('created_at').defaultNow().notNull(),\n});\n\nexport type LandlordWalletBalance = typeof landlordWalletBalances.$inferSelect;\nexport type NewLandlordWalletBalance = typeof landlordWalletBalances.$inferInsert;\nexport type WalletTransaction = typeof walletTransactions.$inferSelect;\nexport type NewWalletTransaction = typeof walletTransactions.$inferInsert;\n"],"names":["landlordWalletBalances","transactionStatusEnum","transactionTypeEnum","walletTransactions","pgEnum","pgTable","id","uuid","defaultRandom","primaryKey","landlordId","references","users","notNull","unique","availableBalance","decimal","precision","scale","default","pendingBalance","totalEarned","totalWithdrawn","currency","varchar","length","createdAt","timestamp","defaultNow","updatedAt","type","amount","balanceBefore","balanceAfter","reference","paymentId","payments","status","description","text","metadata"],"mappings":";;;;;;;;;;;QAsBaA;eAAAA;;QARAC;eAAAA;;QATAC;eAAAA;;QAkCAC;eAAAA;;;wBAvC4D;uBACnD;0BACG;AAGlB,MAAMD,sBAAsBE,IAAAA,cAAM,EAAC,oBAAoB;IAC5D;IACA;IACA;IACA;IACA;CACD;AAGM,MAAMH,wBAAwBG,IAAAA,cAAM,EAAC,sBAAsB;IAChE;IACA;IACA;IACA;CACD;AAGM,MAAMJ,yBAAyBK,IAAAA,eAAO,EAAC,4BAA4B;IACxEC,IAAIC,IAAAA,YAAI,EAAC,MAAMC,aAAa,GAAGC,UAAU;IACzCC,YAAYH,IAAAA,YAAI,EAAC,eAAeI,UAAU,CAAC,IAAMC,YAAK,CAACN,EAAE,EAAEO,OAAO,GAAGC,MAAM;IAE3E,mBAAmB;IACnBC,kBAAkBC,IAAAA,eAAO,EAAC,qBAAqB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGC,OAAO,CAAC,QAAQN,OAAO;IACnGO,gBAAgBJ,IAAAA,eAAO,EAAC,mBAAmB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGC,OAAO,CAAC,QAAQN,OAAO;IAC/FQ,aAAaL,IAAAA,eAAO,EAAC,gBAAgB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGC,OAAO,CAAC,QAAQN,OAAO;IACzFS,gBAAgBN,IAAAA,eAAO,EAAC,mBAAmB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGC,OAAO,CAAC,QAAQN,OAAO;IAE/FU,UAAUC,IAAAA,eAAO,EAAC,YAAY;QAAEC,QAAQ;IAAE,GAAGN,OAAO,CAAC,OAAON,OAAO;IAEnEa,WAAWC,IAAAA,iBAAS,EAAC,cAAcC,UAAU,GAAGf,OAAO;IACvDgB,WAAWF,IAAAA,iBAAS,EAAC,cAAcC,UAAU,GAAGf,OAAO;AACzD;AAGO,MAAMV,qBAAqBE,IAAAA,eAAO,EAAC,uBAAuB;IAC/DC,IAAIC,IAAAA,YAAI,EAAC,MAAMC,aAAa,GAAGC,UAAU;IACzCC,YAAYH,IAAAA,YAAI,EAAC,eAAeI,UAAU,CAAC,IAAMC,YAAK,CAACN,EAAE,EAAEO,OAAO;IAElE,sBAAsB;IACtBiB,MAAM5B,oBAAoB,QAAQW,OAAO;IACzCkB,QAAQf,IAAAA,eAAO,EAAC,UAAU;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGL,OAAO;IAC9DmB,eAAehB,IAAAA,eAAO,EAAC,kBAAkB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGL,OAAO;IAC7EoB,cAAcjB,IAAAA,eAAO,EAAC,iBAAiB;QAAEC,WAAW;QAAIC,OAAO;IAAE,GAAGL,OAAO;IAE3E,aAAa;IACbqB,WAAWV,IAAAA,eAAO,EAAC,aAAa;QAAEC,QAAQ;IAAI;IAC9CU,WAAW5B,IAAAA,YAAI,EAAC,cAAcI,UAAU,CAAC,IAAMyB,kBAAQ,CAAC9B,EAAE;IAE1D,sBAAsB;IACtB+B,QAAQpC,sBAAsB,UAAUkB,OAAO,CAAC,aAAaN,OAAO;IACpEyB,aAAaC,IAAAA,YAAI,EAAC;IAClBC,UAAUD,IAAAA,YAAI,EAAC;IAEfb,WAAWC,IAAAA,iBAAS,EAAC,cAAcC,UAAU,GAAGf,OAAO;AACzD"}