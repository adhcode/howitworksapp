{"version":3,"sources":["../../../src/database/schema/notifications.ts"],"sourcesContent":["import { pgTable, uuid, varchar, text, boolean, timestamp, jsonb } from 'drizzle-orm/pg-core';\nimport { users } from './users';\nimport { relations } from 'drizzle-orm';\n\nexport const pushTokens = pgTable('push_tokens', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  userId: uuid('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  token: varchar('token', { length: 255 }).unique().notNull(),\n  deviceType: varchar('device_type', { length: 50 }),\n  deviceName: varchar('device_name', { length: 255 }),\n  isActive: boolean('is_active').default(true).notNull(),\n  createdAt: timestamp('created_at').defaultNow().notNull(),\n  updatedAt: timestamp('updated_at').defaultNow().notNull(),\n  lastUsedAt: timestamp('last_used_at'),\n});\n\nexport const notifications = pgTable('notifications', {\n  id: uuid('id').primaryKey().defaultRandom(),\n  userId: uuid('user_id').references(() => users.id, { onDelete: 'cascade' }).notNull(),\n  title: varchar('title', { length: 255 }).notNull(),\n  body: text('body').notNull(),\n  data: jsonb('data'),\n  type: varchar('type', { length: 50 }),\n  isRead: boolean('is_read').default(false).notNull(),\n  sentAt: timestamp('sent_at').defaultNow().notNull(),\n  readAt: timestamp('read_at'),\n  pushSent: boolean('push_sent').default(false).notNull(),\n  pushSentAt: timestamp('push_sent_at'),\n});\n\n// Relations\nexport const pushTokensRelations = relations(pushTokens, ({ one }) => ({\n  user: one(users, {\n    fields: [pushTokens.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n}));\n\n// Types\nexport type PushToken = typeof pushTokens.$inferSelect;\nexport type NewPushToken = typeof pushTokens.$inferInsert;\nexport type Notification = typeof notifications.$inferSelect;\nexport type NewNotification = typeof notifications.$inferInsert;\n"],"names":["notifications","notificationsRelations","pushTokens","pushTokensRelations","pgTable","id","uuid","primaryKey","defaultRandom","userId","references","users","onDelete","notNull","token","varchar","length","unique","deviceType","deviceName","isActive","boolean","default","createdAt","timestamp","defaultNow","updatedAt","lastUsedAt","title","body","text","data","jsonb","type","isRead","sentAt","readAt","pushSent","pushSentAt","relations","one","user","fields"],"mappings":";;;;;;;;;;;QAgBaA;eAAAA;;QAsBAC;eAAAA;;QAlCAC;eAAAA;;QA2BAC;eAAAA;;;wBA/B2D;uBAClD;4BACI;AAEnB,MAAMD,aAAaE,IAAAA,eAAO,EAAC,eAAe;IAC/CC,IAAIC,IAAAA,YAAI,EAAC,MAAMC,UAAU,GAAGC,aAAa;IACzCC,QAAQH,IAAAA,YAAI,EAAC,WAAWI,UAAU,CAAC,IAAMC,YAAK,CAACN,EAAE,EAAE;QAAEO,UAAU;IAAU,GAAGC,OAAO;IACnFC,OAAOC,IAAAA,eAAO,EAAC,SAAS;QAAEC,QAAQ;IAAI,GAAGC,MAAM,GAAGJ,OAAO;IACzDK,YAAYH,IAAAA,eAAO,EAAC,eAAe;QAAEC,QAAQ;IAAG;IAChDG,YAAYJ,IAAAA,eAAO,EAAC,eAAe;QAAEC,QAAQ;IAAI;IACjDI,UAAUC,IAAAA,eAAO,EAAC,aAAaC,OAAO,CAAC,MAAMT,OAAO;IACpDU,WAAWC,IAAAA,iBAAS,EAAC,cAAcC,UAAU,GAAGZ,OAAO;IACvDa,WAAWF,IAAAA,iBAAS,EAAC,cAAcC,UAAU,GAAGZ,OAAO;IACvDc,YAAYH,IAAAA,iBAAS,EAAC;AACxB;AAEO,MAAMxB,gBAAgBI,IAAAA,eAAO,EAAC,iBAAiB;IACpDC,IAAIC,IAAAA,YAAI,EAAC,MAAMC,UAAU,GAAGC,aAAa;IACzCC,QAAQH,IAAAA,YAAI,EAAC,WAAWI,UAAU,CAAC,IAAMC,YAAK,CAACN,EAAE,EAAE;QAAEO,UAAU;IAAU,GAAGC,OAAO;IACnFe,OAAOb,IAAAA,eAAO,EAAC,SAAS;QAAEC,QAAQ;IAAI,GAAGH,OAAO;IAChDgB,MAAMC,IAAAA,YAAI,EAAC,QAAQjB,OAAO;IAC1BkB,MAAMC,IAAAA,aAAK,EAAC;IACZC,MAAMlB,IAAAA,eAAO,EAAC,QAAQ;QAAEC,QAAQ;IAAG;IACnCkB,QAAQb,IAAAA,eAAO,EAAC,WAAWC,OAAO,CAAC,OAAOT,OAAO;IACjDsB,QAAQX,IAAAA,iBAAS,EAAC,WAAWC,UAAU,GAAGZ,OAAO;IACjDuB,QAAQZ,IAAAA,iBAAS,EAAC;IAClBa,UAAUhB,IAAAA,eAAO,EAAC,aAAaC,OAAO,CAAC,OAAOT,OAAO;IACrDyB,YAAYd,IAAAA,iBAAS,EAAC;AACxB;AAGO,MAAMrB,sBAAsBoC,IAAAA,qBAAS,EAACrC,YAAY,CAAC,EAAEsC,GAAG,EAAE,GAAM,CAAA;QACrEC,MAAMD,IAAI7B,YAAK,EAAE;YACf+B,QAAQ;gBAACxC,WAAWO,MAAM;aAAC;YAC3BC,YAAY;gBAACC,YAAK,CAACN,EAAE;aAAC;QACxB;IACF,CAAA;AAEO,MAAMJ,yBAAyBsC,IAAAA,qBAAS,EAACvC,eAAe,CAAC,EAAEwC,GAAG,EAAE,GAAM,CAAA;QAC3EC,MAAMD,IAAI7B,YAAK,EAAE;YACf+B,QAAQ;gBAAC1C,cAAcS,MAAM;aAAC;YAC9BC,YAAY;gBAACC,YAAK,CAACN,EAAE;aAAC;QACxB;IACF,CAAA"}