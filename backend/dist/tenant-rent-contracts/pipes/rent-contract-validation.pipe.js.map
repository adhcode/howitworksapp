{"version":3,"sources":["../../../src/tenant-rent-contracts/pipes/rent-contract-validation.pipe.ts"],"sourcesContent":["import {\n  PipeTransform,\n  Injectable,\n  ArgumentMetadata,\n  BadRequestException,\n} from '@nestjs/common';\nimport { validate } from 'class-validator';\nimport { plainToClass } from 'class-transformer';\n\n@Injectable()\nexport class RentContractValidationPipe implements PipeTransform<any> {\n  async transform(value: any, { metatype }: ArgumentMetadata) {\n    if (!metatype || !this.toValidate(metatype)) {\n      return value;\n    }\n\n    const object = plainToClass(metatype, value);\n    const errors = await validate(object, {\n      whitelist: true, // Strip properties that don't have decorators\n      forbidNonWhitelisted: true, // Throw error if non-whitelisted properties are present\n      transform: true, // Transform the object to the target type\n      validateCustomDecorators: true, // Validate custom decorators\n    });\n\n    if (errors.length > 0) {\n      const errorMessages = this.formatValidationErrors(errors);\n      throw new BadRequestException({\n        statusCode: 400,\n        error: 'Validation Failed',\n        message: 'Input validation failed for rent contract operation',\n        details: errorMessages,\n      });\n    }\n\n    return object;\n  }\n\n  private toValidate(metatype: Function): boolean {\n    const types: Function[] = [String, Boolean, Number, Array, Object];\n    return !types.includes(metatype);\n  }\n\n  private formatValidationErrors(errors: any[]): any[] {\n    return errors.map(error => ({\n      property: error.property,\n      value: error.value,\n      constraints: error.constraints,\n      children: error.children?.length > 0 ? this.formatValidationErrors(error.children) : undefined,\n    }));\n  }\n}"],"names":["RentContractValidationPipe","transform","value","metatype","toValidate","object","plainToClass","errors","validate","whitelist","forbidNonWhitelisted","validateCustomDecorators","length","errorMessages","formatValidationErrors","BadRequestException","statusCode","error","message","details","types","String","Boolean","Number","Array","Object","includes","map","property","constraints","children","undefined"],"mappings":";;;;+BAUaA;;;eAAAA;;;wBALN;gCACkB;kCACI;;;;;;;AAGtB,IAAA,AAAMA,6BAAN,MAAMA;IACX,MAAMC,UAAUC,KAAU,EAAE,EAAEC,QAAQ,EAAoB,EAAE;QAC1D,IAAI,CAACA,YAAY,CAAC,IAAI,CAACC,UAAU,CAACD,WAAW;YAC3C,OAAOD;QACT;QAEA,MAAMG,SAASC,IAAAA,8BAAY,EAACH,UAAUD;QACtC,MAAMK,SAAS,MAAMC,IAAAA,wBAAQ,EAACH,QAAQ;YACpCI,WAAW;YACXC,sBAAsB;YACtBT,WAAW;YACXU,0BAA0B;QAC5B;QAEA,IAAIJ,OAAOK,MAAM,GAAG,GAAG;YACrB,MAAMC,gBAAgB,IAAI,CAACC,sBAAsB,CAACP;YAClD,MAAM,IAAIQ,2BAAmB,CAAC;gBAC5BC,YAAY;gBACZC,OAAO;gBACPC,SAAS;gBACTC,SAASN;YACX;QACF;QAEA,OAAOR;IACT;IAEQD,WAAWD,QAAkB,EAAW;QAC9C,MAAMiB,QAAoB;YAACC;YAAQC;YAASC;YAAQC;YAAOC;SAAO;QAClE,OAAO,CAACL,MAAMM,QAAQ,CAACvB;IACzB;IAEQW,uBAAuBP,MAAa,EAAS;QACnD,OAAOA,OAAOoB,GAAG,CAACV,CAAAA,QAAU,CAAA;gBAC1BW,UAAUX,MAAMW,QAAQ;gBACxB1B,OAAOe,MAAMf,KAAK;gBAClB2B,aAAaZ,MAAMY,WAAW;gBAC9BC,UAAUb,MAAMa,QAAQ,EAAElB,SAAS,IAAI,IAAI,CAACE,sBAAsB,CAACG,MAAMa,QAAQ,IAAIC;YACvF,CAAA;IACF;AACF"}