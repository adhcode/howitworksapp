{"version":3,"sources":["../../../src/tenant-rent-contracts/validators/custom-validators.spec.ts"],"sourcesContent":["import { validate } from 'class-validator';\nimport { \n  IsFutureDate, \n  IsAfterOriginalExpiry, \n  IsReasonableRentAmount, \n  IsValidContractDuration,\n  IsValidOriginalExpiry\n} from './custom-validators';\n\nclass TestDto {\n  @IsFutureDate()\n  futureDate?: string;\n\n  @IsAfterOriginalExpiry()\n  expiryDate?: string;\n\n  originalExpiryDate?: string;\n\n  @IsReasonableRentAmount()\n  rentAmount?: number;\n\n  @IsValidContractDuration()\n  contractExpiryDate?: string;\n\n  @IsValidOriginalExpiry()\n  originalExpiry?: string;\n\n  isExistingTenant?: boolean;\n}\n\ndescribe('Custom Validators', () => {\n  describe('IsFutureDate', () => {\n    it('should pass for future dates', async () => {\n      const dto = new TestDto();\n      const futureDate = new Date();\n      futureDate.setDate(futureDate.getDate() + 1);\n      dto.futureDate = futureDate.toISOString();\n\n      const errors = await validate(dto);\n      const futureDateErrors = errors.filter(e => e.property === 'futureDate');\n      expect(futureDateErrors).toHaveLength(0);\n    });\n\n    it('should fail for past dates', async () => {\n      const dto = new TestDto();\n      const pastDate = new Date();\n      pastDate.setDate(pastDate.getDate() - 1);\n      dto.futureDate = pastDate.toISOString();\n\n      const errors = await validate(dto);\n      const futureDateErrors = errors.filter(e => e.property === 'futureDate');\n      expect(futureDateErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should fail for today', async () => {\n      const dto = new TestDto();\n      dto.futureDate = new Date().toISOString();\n\n      const errors = await validate(dto);\n      const futureDateErrors = errors.filter(e => e.property === 'futureDate');\n      expect(futureDateErrors.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('IsAfterOriginalExpiry', () => {\n    it('should pass when expiry is after original expiry', async () => {\n      const dto = new TestDto();\n      dto.originalExpiryDate = '2024-06-01T00:00:00.000Z';\n      dto.expiryDate = '2024-12-01T00:00:00.000Z';\n\n      const errors = await validate(dto);\n      const expiryErrors = errors.filter(e => e.property === 'expiryDate');\n      expect(expiryErrors).toHaveLength(0);\n    });\n\n    it('should fail when expiry is before original expiry', async () => {\n      const dto = new TestDto();\n      dto.originalExpiryDate = '2024-12-01T00:00:00.000Z';\n      dto.expiryDate = '2024-06-01T00:00:00.000Z';\n\n      const errors = await validate(dto);\n      const expiryErrors = errors.filter(e => e.property === 'expiryDate');\n      expect(expiryErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should pass when original expiry is not provided', async () => {\n      const dto = new TestDto();\n      dto.expiryDate = '2024-12-01T00:00:00.000Z';\n\n      const errors = await validate(dto);\n      const expiryErrors = errors.filter(e => e.property === 'expiryDate');\n      expect(expiryErrors).toHaveLength(0);\n    });\n  });\n\n  describe('IsReasonableRentAmount', () => {\n    it('should pass for reasonable amounts', async () => {\n      const dto = new TestDto();\n      dto.rentAmount = 25000;\n\n      const errors = await validate(dto);\n      const rentErrors = errors.filter(e => e.property === 'rentAmount');\n      expect(rentErrors).toHaveLength(0);\n    });\n\n    it('should fail for amounts below minimum', async () => {\n      const dto = new TestDto();\n      dto.rentAmount = 500;\n\n      const errors = await validate(dto);\n      const rentErrors = errors.filter(e => e.property === 'rentAmount');\n      expect(rentErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should fail for amounts above maximum', async () => {\n      const dto = new TestDto();\n      dto.rentAmount = 15000000;\n\n      const errors = await validate(dto);\n      const rentErrors = errors.filter(e => e.property === 'rentAmount');\n      expect(rentErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should fail for non-numeric values', async () => {\n      const dto = new TestDto();\n      dto.rentAmount = 'not-a-number' as any;\n\n      const errors = await validate(dto);\n      const rentErrors = errors.filter(e => e.property === 'rentAmount');\n      expect(rentErrors.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('IsValidContractDuration', () => {\n    it('should pass for valid contract duration', async () => {\n      const dto = new TestDto();\n      const futureDate = new Date();\n      futureDate.setMonth(futureDate.getMonth() + 12); // 1 year from now\n      dto.contractExpiryDate = futureDate.toISOString();\n\n      const errors = await validate(dto);\n      const durationErrors = errors.filter(e => e.property === 'contractExpiryDate');\n      expect(durationErrors).toHaveLength(0);\n    });\n\n    it('should fail for too short contract duration', async () => {\n      const dto = new TestDto();\n      const shortDate = new Date();\n      shortDate.setMonth(shortDate.getMonth() + 2); // 2 months from now\n      dto.contractExpiryDate = shortDate.toISOString();\n\n      const errors = await validate(dto);\n      const durationErrors = errors.filter(e => e.property === 'contractExpiryDate');\n      expect(durationErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should fail for too long contract duration', async () => {\n      const dto = new TestDto();\n      const longDate = new Date();\n      longDate.setFullYear(longDate.getFullYear() + 6); // 6 years from now\n      dto.contractExpiryDate = longDate.toISOString();\n\n      const errors = await validate(dto);\n      const durationErrors = errors.filter(e => e.property === 'contractExpiryDate');\n      expect(durationErrors.length).toBeGreaterThan(0);\n    });\n  });\n\n  describe('IsValidOriginalExpiry', () => {\n    it('should pass for existing tenant with valid original expiry', async () => {\n      const dto = new TestDto();\n      dto.isExistingTenant = true;\n      const validDate = new Date();\n      validDate.setMonth(validDate.getMonth() + 3); // 3 months from now\n      dto.originalExpiry = validDate.toISOString();\n\n      const errors = await validate(dto);\n      const originalErrors = errors.filter(e => e.property === 'originalExpiry');\n      expect(originalErrors).toHaveLength(0);\n    });\n\n    it('should pass for new tenant without original expiry', async () => {\n      const dto = new TestDto();\n      dto.isExistingTenant = false;\n\n      const errors = await validate(dto);\n      const originalErrors = errors.filter(e => e.property === 'originalExpiry');\n      expect(originalErrors).toHaveLength(0);\n    });\n\n    it('should fail for existing tenant without original expiry', async () => {\n      const dto = new TestDto();\n      dto.isExistingTenant = true;\n\n      const errors = await validate(dto);\n      const originalErrors = errors.filter(e => e.property === 'originalExpiry');\n      expect(originalErrors.length).toBeGreaterThan(0);\n    });\n\n    it('should fail for original expiry too far in future', async () => {\n      const dto = new TestDto();\n      dto.isExistingTenant = true;\n      const farFutureDate = new Date();\n      farFutureDate.setMonth(farFutureDate.getMonth() + 12); // 12 months from now\n      dto.originalExpiry = farFutureDate.toISOString();\n\n      const errors = await validate(dto);\n      const originalErrors = errors.filter(e => e.property === 'originalExpiry');\n      expect(originalErrors.length).toBeGreaterThan(0);\n    });\n  });\n});"],"names":["TestDto","describe","it","dto","futureDate","Date","setDate","getDate","toISOString","errors","validate","futureDateErrors","filter","e","property","expect","toHaveLength","pastDate","length","toBeGreaterThan","originalExpiryDate","expiryDate","expiryErrors","rentAmount","rentErrors","setMonth","getMonth","contractExpiryDate","durationErrors","shortDate","longDate","setFullYear","getFullYear","isExistingTenant","validDate","originalExpiry","originalErrors","farFutureDate"],"mappings":";;;;gCAAyB;kCAOlB;;;;;;;;;;AAEP,IAAA,AAAMA,UAAN,MAAMA;AAmBN;;;;;;;;;;;;;;;;;;;;;AAEAC,SAAS,qBAAqB;IAC5BA,SAAS,gBAAgB;QACvBC,GAAG,gCAAgC;YACjC,MAAMC,MAAM,IAAIH;YAChB,MAAMI,aAAa,IAAIC;YACvBD,WAAWE,OAAO,CAACF,WAAWG,OAAO,KAAK;YAC1CJ,IAAIC,UAAU,GAAGA,WAAWI,WAAW;YAEvC,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMQ,mBAAmBF,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YAC3DC,OAAOJ,kBAAkBK,YAAY,CAAC;QACxC;QAEAd,GAAG,8BAA8B;YAC/B,MAAMC,MAAM,IAAIH;YAChB,MAAMiB,WAAW,IAAIZ;YACrBY,SAASX,OAAO,CAACW,SAASV,OAAO,KAAK;YACtCJ,IAAIC,UAAU,GAAGa,SAAST,WAAW;YAErC,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMQ,mBAAmBF,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YAC3DC,OAAOJ,iBAAiBO,MAAM,EAAEC,eAAe,CAAC;QAClD;QAEAjB,GAAG,yBAAyB;YAC1B,MAAMC,MAAM,IAAIH;YAChBG,IAAIC,UAAU,GAAG,IAAIC,OAAOG,WAAW;YAEvC,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMQ,mBAAmBF,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YAC3DC,OAAOJ,iBAAiBO,MAAM,EAAEC,eAAe,CAAC;QAClD;IACF;IAEAlB,SAAS,yBAAyB;QAChCC,GAAG,oDAAoD;YACrD,MAAMC,MAAM,IAAIH;YAChBG,IAAIiB,kBAAkB,GAAG;YACzBjB,IAAIkB,UAAU,GAAG;YAEjB,MAAMZ,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMmB,eAAeb,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACvDC,OAAOO,cAAcN,YAAY,CAAC;QACpC;QAEAd,GAAG,qDAAqD;YACtD,MAAMC,MAAM,IAAIH;YAChBG,IAAIiB,kBAAkB,GAAG;YACzBjB,IAAIkB,UAAU,GAAG;YAEjB,MAAMZ,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMmB,eAAeb,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACvDC,OAAOO,aAAaJ,MAAM,EAAEC,eAAe,CAAC;QAC9C;QAEAjB,GAAG,oDAAoD;YACrD,MAAMC,MAAM,IAAIH;YAChBG,IAAIkB,UAAU,GAAG;YAEjB,MAAMZ,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMmB,eAAeb,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACvDC,OAAOO,cAAcN,YAAY,CAAC;QACpC;IACF;IAEAf,SAAS,0BAA0B;QACjCC,GAAG,sCAAsC;YACvC,MAAMC,MAAM,IAAIH;YAChBG,IAAIoB,UAAU,GAAG;YAEjB,MAAMd,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMqB,aAAaf,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACrDC,OAAOS,YAAYR,YAAY,CAAC;QAClC;QAEAd,GAAG,yCAAyC;YAC1C,MAAMC,MAAM,IAAIH;YAChBG,IAAIoB,UAAU,GAAG;YAEjB,MAAMd,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMqB,aAAaf,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACrDC,OAAOS,WAAWN,MAAM,EAAEC,eAAe,CAAC;QAC5C;QAEAjB,GAAG,yCAAyC;YAC1C,MAAMC,MAAM,IAAIH;YAChBG,IAAIoB,UAAU,GAAG;YAEjB,MAAMd,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMqB,aAAaf,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACrDC,OAAOS,WAAWN,MAAM,EAAEC,eAAe,CAAC;QAC5C;QAEAjB,GAAG,sCAAsC;YACvC,MAAMC,MAAM,IAAIH;YAChBG,IAAIoB,UAAU,GAAG;YAEjB,MAAMd,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMqB,aAAaf,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACrDC,OAAOS,WAAWN,MAAM,EAAEC,eAAe,CAAC;QAC5C;IACF;IAEAlB,SAAS,2BAA2B;QAClCC,GAAG,2CAA2C;YAC5C,MAAMC,MAAM,IAAIH;YAChB,MAAMI,aAAa,IAAIC;YACvBD,WAAWqB,QAAQ,CAACrB,WAAWsB,QAAQ,KAAK,KAAK,kBAAkB;YACnEvB,IAAIwB,kBAAkB,GAAGvB,WAAWI,WAAW;YAE/C,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMyB,iBAAiBnB,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOa,gBAAgBZ,YAAY,CAAC;QACtC;QAEAd,GAAG,+CAA+C;YAChD,MAAMC,MAAM,IAAIH;YAChB,MAAM6B,YAAY,IAAIxB;YACtBwB,UAAUJ,QAAQ,CAACI,UAAUH,QAAQ,KAAK,IAAI,oBAAoB;YAClEvB,IAAIwB,kBAAkB,GAAGE,UAAUrB,WAAW;YAE9C,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMyB,iBAAiBnB,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOa,eAAeV,MAAM,EAAEC,eAAe,CAAC;QAChD;QAEAjB,GAAG,8CAA8C;YAC/C,MAAMC,MAAM,IAAIH;YAChB,MAAM8B,WAAW,IAAIzB;YACrByB,SAASC,WAAW,CAACD,SAASE,WAAW,KAAK,IAAI,mBAAmB;YACrE7B,IAAIwB,kBAAkB,GAAGG,SAAStB,WAAW;YAE7C,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMyB,iBAAiBnB,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOa,eAAeV,MAAM,EAAEC,eAAe,CAAC;QAChD;IACF;IAEAlB,SAAS,yBAAyB;QAChCC,GAAG,8DAA8D;YAC/D,MAAMC,MAAM,IAAIH;YAChBG,IAAI8B,gBAAgB,GAAG;YACvB,MAAMC,YAAY,IAAI7B;YACtB6B,UAAUT,QAAQ,CAACS,UAAUR,QAAQ,KAAK,IAAI,oBAAoB;YAClEvB,IAAIgC,cAAc,GAAGD,UAAU1B,WAAW;YAE1C,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMiC,iBAAiB3B,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOqB,gBAAgBpB,YAAY,CAAC;QACtC;QAEAd,GAAG,sDAAsD;YACvD,MAAMC,MAAM,IAAIH;YAChBG,IAAI8B,gBAAgB,GAAG;YAEvB,MAAMxB,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMiC,iBAAiB3B,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOqB,gBAAgBpB,YAAY,CAAC;QACtC;QAEAd,GAAG,2DAA2D;YAC5D,MAAMC,MAAM,IAAIH;YAChBG,IAAI8B,gBAAgB,GAAG;YAEvB,MAAMxB,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMiC,iBAAiB3B,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOqB,eAAelB,MAAM,EAAEC,eAAe,CAAC;QAChD;QAEAjB,GAAG,qDAAqD;YACtD,MAAMC,MAAM,IAAIH;YAChBG,IAAI8B,gBAAgB,GAAG;YACvB,MAAMI,gBAAgB,IAAIhC;YAC1BgC,cAAcZ,QAAQ,CAACY,cAAcX,QAAQ,KAAK,KAAK,qBAAqB;YAC5EvB,IAAIgC,cAAc,GAAGE,cAAc7B,WAAW;YAE9C,MAAMC,SAAS,MAAMC,IAAAA,wBAAQ,EAACP;YAC9B,MAAMiC,iBAAiB3B,OAAOG,MAAM,CAACC,CAAAA,IAAKA,EAAEC,QAAQ,KAAK;YACzDC,OAAOqB,eAAelB,MAAM,EAAEC,eAAe,CAAC;QAChD;IACF;AACF"}