{"version":3,"sources":["../../../src/tenant-rent-contracts/validators/custom-validators.ts"],"sourcesContent":["import {\n  registerDecorator,\n  ValidationOptions,\n  ValidatorConstraint,\n  ValidatorConstraintInterface,\n  ValidationArguments,\n} from 'class-validator';\n\n// Custom validator for future dates\n@ValidatorConstraint({ async: false })\nexport class IsFutureDateConstraint implements ValidatorConstraintInterface {\n  validate(date: string, args: ValidationArguments) {\n    if (!date) return false;\n    \n    const inputDate = new Date(date);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0); // Reset time to start of day\n    \n    return inputDate > today;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return `${args.property} must be a future date`;\n  }\n}\n\nexport function IsFutureDate(validationOptions?: ValidationOptions) {\n  return function (object: Object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsFutureDateConstraint,\n    });\n  };\n}\n\n// Custom validator for expiry date being after original expiry date\n@ValidatorConstraint({ async: false })\nexport class IsAfterOriginalExpiryConstraint implements ValidatorConstraintInterface {\n  validate(expiryDate: string, args: ValidationArguments) {\n    const object = args.object as any;\n    \n    if (!object.originalExpiryDate || !expiryDate) {\n      return true; // Skip validation if either date is missing\n    }\n    \n    const expiry = new Date(expiryDate);\n    const originalExpiry = new Date(object.originalExpiryDate);\n    \n    return expiry > originalExpiry;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return 'Expiry date must be after the original expiry date for existing tenants';\n  }\n}\n\nexport function IsAfterOriginalExpiry(validationOptions?: ValidationOptions) {\n  return function (object: Object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsAfterOriginalExpiryConstraint,\n    });\n  };\n}\n\n// Custom validator for reasonable rent amounts\n@ValidatorConstraint({ async: false })\nexport class IsReasonableRentAmountConstraint implements ValidatorConstraintInterface {\n  validate(amount: number, args: ValidationArguments) {\n    if (typeof amount !== 'number') return false;\n    \n    // Rent should be between 1,000 and 10,000,000 (reasonable range)\n    return amount >= 1000 && amount <= 10000000;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return 'Monthly rent amount must be between ₦1,000 and ₦10,000,000';\n  }\n}\n\nexport function IsReasonableRentAmount(validationOptions?: ValidationOptions) {\n  return function (object: Object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsReasonableRentAmountConstraint,\n    });\n  };\n}\n\n// Custom validator for contract duration (minimum 3 months, maximum 5 years)\n@ValidatorConstraint({ async: false })\nexport class IsValidContractDurationConstraint implements ValidatorConstraintInterface {\n  validate(expiryDate: string, args: ValidationArguments) {\n    if (!expiryDate) return false;\n    \n    const expiry = new Date(expiryDate);\n    const today = new Date();\n    \n    // Calculate months difference\n    const monthsDiff = (expiry.getFullYear() - today.getFullYear()) * 12 + \n                      (expiry.getMonth() - today.getMonth());\n    \n    // Contract should be between 3 months and 60 months (5 years)\n    return monthsDiff >= 3 && monthsDiff <= 60;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return 'Contract duration must be between 3 months and 5 years from today';\n  }\n}\n\nexport function IsValidContractDuration(validationOptions?: ValidationOptions) {\n  return function (object: Object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsValidContractDurationConstraint,\n    });\n  };\n}\n\n// Custom validator for original expiry date being in the past or near future for existing tenants\n@ValidatorConstraint({ async: false })\nexport class IsValidOriginalExpiryConstraint implements ValidatorConstraintInterface {\n  validate(originalExpiryDate: string, args: ValidationArguments) {\n    const object = args.object as any;\n    \n    if (!object.isExistingTenant) {\n      return true; // Skip validation for new tenants\n    }\n    \n    if (!originalExpiryDate) {\n      return false; // Original expiry date is required for existing tenants\n    }\n    \n    const originalExpiry = new Date(originalExpiryDate);\n    const today = new Date();\n    const sixMonthsFromNow = new Date();\n    sixMonthsFromNow.setMonth(today.getMonth() + 6);\n    \n    // Original expiry should be within 6 months from now (past or future)\n    return originalExpiry <= sixMonthsFromNow;\n  }\n\n  defaultMessage(args: ValidationArguments) {\n    return 'Original expiry date must be within 6 months from today for existing tenants';\n  }\n}\n\nexport function IsValidOriginalExpiry(validationOptions?: ValidationOptions) {\n  return function (object: Object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsValidOriginalExpiryConstraint,\n    });\n  };\n}"],"names":["IsAfterOriginalExpiry","IsAfterOriginalExpiryConstraint","IsFutureDate","IsFutureDateConstraint","IsReasonableRentAmount","IsReasonableRentAmountConstraint","IsValidContractDuration","IsValidContractDurationConstraint","IsValidOriginalExpiry","IsValidOriginalExpiryConstraint","validate","date","args","inputDate","Date","today","setHours","defaultMessage","property","async","validationOptions","object","propertyName","registerDecorator","target","options","constraints","validator","expiryDate","originalExpiryDate","expiry","originalExpiry","amount","monthsDiff","getFullYear","getMonth","isExistingTenant","sixMonthsFromNow","setMonth"],"mappings":"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"}