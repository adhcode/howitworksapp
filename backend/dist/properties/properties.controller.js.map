{"version":3,"sources":["../../src/properties/properties.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Body,\n  Patch,\n  Param,\n  Delete,\n  UseGuards,\n  Request,\n  Query,\n} from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse, ApiBearerAuth } from '@nestjs/swagger';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { PropertiesService } from './properties.service';\nimport { CreatePropertyDto, UpdatePropertyDto } from './dto/property.dto';\nimport { PaginationDto } from '../common/dto/pagination.dto';\n\n@ApiTags('Properties')\n@Controller('properties')\n@UseGuards(JwtAuthGuard)\n@ApiBearerAuth('JWT-auth')\nexport class PropertiesController {\n  constructor(private readonly propertiesService: PropertiesService) {}\n\n  @Post()\n  @ApiOperation({ summary: 'Create a new property' })\n  @ApiResponse({ status: 201, description: 'Property created successfully' })\n  async create(@Request() req, @Body() createPropertyDto: CreatePropertyDto) {\n    return this.propertiesService.create(req.user.id, createPropertyDto);\n  }\n\n  @Get()\n  @ApiOperation({ summary: 'Get all properties for the authenticated landlord' })\n  @ApiResponse({ status: 200, description: 'Properties retrieved successfully' })\n  async findAll(@Request() req, @Query() pagination: PaginationDto) {\n    const result = await this.propertiesService.findAll(req.user.id, pagination);\n    \n    return {\n      data: result.data,\n      meta: {\n        total: result.total,\n        page: pagination.page || 1,\n        limit: pagination.limit || 10,\n        totalPages: Math.ceil(result.total / (pagination.limit || 10)),\n        hasNextPage: (pagination.page || 1) * (pagination.limit || 10) < result.total,\n        hasPrevPage: (pagination.page || 1) > 1,\n      },\n    };\n  }\n\n  @Get('stats')\n  @ApiOperation({ summary: 'Get property statistics for the authenticated landlord' })\n  @ApiResponse({ status: 200, description: 'Statistics retrieved successfully' })\n  async getStats(@Request() req) {\n    return this.propertiesService.getStats(req.user.id);\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get a specific property' })\n  @ApiResponse({ status: 200, description: 'Property retrieved successfully' })\n  @ApiResponse({ status: 404, description: 'Property not found' })\n  async findOne(@Request() req, @Param('id') id: string) {\n    return this.propertiesService.findOne(id, req.user.id);\n  }\n\n  @Get(':id/with-units')\n  @ApiOperation({ summary: 'Get a property with its units' })\n  @ApiResponse({ status: 200, description: 'Property with units retrieved successfully' })\n  @ApiResponse({ status: 404, description: 'Property not found' })\n  async findWithUnits(@Request() req, @Param('id') id: string) {\n    return this.propertiesService.findWithUnits(id, req.user.id);\n  }\n\n  @Patch(':id')\n  @ApiOperation({ summary: 'Update a property' })\n  @ApiResponse({ status: 200, description: 'Property updated successfully' })\n  @ApiResponse({ status: 404, description: 'Property not found' })\n  async update(\n    @Request() req,\n    @Param('id') id: string,\n    @Body() updatePropertyDto: UpdatePropertyDto,\n  ) {\n    return this.propertiesService.update(id, req.user.id, updatePropertyDto);\n  }\n\n  @Delete(':id')\n  @ApiOperation({ summary: 'Delete a property' })\n  @ApiResponse({ status: 200, description: 'Property deleted successfully' })\n  @ApiResponse({ status: 404, description: 'Property not found' })\n  async remove(@Request() req, @Param('id') id: string) {\n    await this.propertiesService.remove(id, req.user.id);\n    return { message: 'Property deleted successfully' };\n  }\n}"],"names":["PropertiesController","create","req","createPropertyDto","propertiesService","user","id","findAll","pagination","result","data","meta","total","page","limit","totalPages","Math","ceil","hasNextPage","hasPrevPage","getStats","findOne","findWithUnits","update","updatePropertyDto","remove","message","summary","status","description"],"mappings":";;;;+BAsBaA;;;eAAAA;;;wBAXN;yBAC2D;8BACrC;mCACK;6BACmB;+BACvB;;;;;;;;;;;;;;;AAMvB,IAAA,AAAMA,uBAAN,MAAMA;IAGX,MAGMC,OAAO,AAAWC,GAAG,EAAE,AAAQC,iBAAoC,EAAE;QACzE,OAAO,IAAI,CAACC,iBAAiB,CAACH,MAAM,CAACC,IAAIG,IAAI,CAACC,EAAE,EAAEH;IACpD;IAEA,MAGMI,QAAQ,AAAWL,GAAG,EAAE,AAASM,UAAyB,EAAE;QAChE,MAAMC,SAAS,MAAM,IAAI,CAACL,iBAAiB,CAACG,OAAO,CAACL,IAAIG,IAAI,CAACC,EAAE,EAAEE;QAEjE,OAAO;YACLE,MAAMD,OAAOC,IAAI;YACjBC,MAAM;gBACJC,OAAOH,OAAOG,KAAK;gBACnBC,MAAML,WAAWK,IAAI,IAAI;gBACzBC,OAAON,WAAWM,KAAK,IAAI;gBAC3BC,YAAYC,KAAKC,IAAI,CAACR,OAAOG,KAAK,GAAIJ,CAAAA,WAAWM,KAAK,IAAI,EAAC;gBAC3DI,aAAa,AAACV,CAAAA,WAAWK,IAAI,IAAI,CAAA,IAAML,CAAAA,WAAWM,KAAK,IAAI,EAAC,IAAKL,OAAOG,KAAK;gBAC7EO,aAAa,AAACX,CAAAA,WAAWK,IAAI,IAAI,CAAA,IAAK;YACxC;QACF;IACF;IAEA,MAGMO,SAAS,AAAWlB,GAAG,EAAE;QAC7B,OAAO,IAAI,CAACE,iBAAiB,CAACgB,QAAQ,CAAClB,IAAIG,IAAI,CAACC,EAAE;IACpD;IAEA,MAIMe,QAAQ,AAAWnB,GAAG,EAAE,AAAaI,EAAU,EAAE;QACrD,OAAO,IAAI,CAACF,iBAAiB,CAACiB,OAAO,CAACf,IAAIJ,IAAIG,IAAI,CAACC,EAAE;IACvD;IAEA,MAIMgB,cAAc,AAAWpB,GAAG,EAAE,AAAaI,EAAU,EAAE;QAC3D,OAAO,IAAI,CAACF,iBAAiB,CAACkB,aAAa,CAAChB,IAAIJ,IAAIG,IAAI,CAACC,EAAE;IAC7D;IAEA,MAIMiB,OACJ,AAAWrB,GAAG,EACd,AAAaI,EAAU,EACvB,AAAQkB,iBAAoC,EAC5C;QACA,OAAO,IAAI,CAACpB,iBAAiB,CAACmB,MAAM,CAACjB,IAAIJ,IAAIG,IAAI,CAACC,EAAE,EAAEkB;IACxD;IAEA,MAIMC,OAAO,AAAWvB,GAAG,EAAE,AAAaI,EAAU,EAAE;QACpD,MAAM,IAAI,CAACF,iBAAiB,CAACqB,MAAM,CAACnB,IAAIJ,IAAIG,IAAI,CAACC,EAAE;QACnD,OAAO;YAAEoB,SAAS;QAAgC;IACpD;IAtEA,YAAY,AAAiBtB,iBAAoC,CAAE;aAAtCA,oBAAAA;IAAuC;AAuEtE;;;;QApEkBuB,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAkBzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;;QAUzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa"}