{"version":3,"sources":["../../../src/auth/guards/roles.guard.ts"],"sourcesContent":["import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';\nimport { Reflector } from '@nestjs/core';\nimport { UserRole } from '../dto/auth.dto';\n\n@Injectable()\nexport class RolesGuard implements CanActivate {\n  constructor(private reflector: Reflector) {}\n\n  canActivate(context: ExecutionContext): boolean {\n    const requiredRoles = this.reflector.getAllAndOverride<UserRole[]>('roles', [\n      context.getHandler(),\n      context.getClass(),\n    ]);\n\n    if (!requiredRoles) {\n      return true;\n    }\n\n    const { user } = context.switchToHttp().getRequest();\n    return requiredRoles.some((role) => user?.role === role);\n  }\n}\n\n\n"],"names":["RolesGuard","canActivate","context","requiredRoles","reflector","getAllAndOverride","getHandler","getClass","user","switchToHttp","getRequest","some","role"],"mappings":";;;;+BAKaA;;;eAAAA;;;wBAL6C;sBAChC;;;;;;;;;;AAInB,IAAA,AAAMA,aAAN,MAAMA;IAGXC,YAAYC,OAAyB,EAAW;QAC9C,MAAMC,gBAAgB,IAAI,CAACC,SAAS,CAACC,iBAAiB,CAAa,SAAS;YAC1EH,QAAQI,UAAU;YAClBJ,QAAQK,QAAQ;SACjB;QAED,IAAI,CAACJ,eAAe;YAClB,OAAO;QACT;QAEA,MAAM,EAAEK,IAAI,EAAE,GAAGN,QAAQO,YAAY,GAAGC,UAAU;QAClD,OAAOP,cAAcQ,IAAI,CAAC,CAACC,OAASJ,MAAMI,SAASA;IACrD;IAdA,YAAY,AAAQR,SAAoB,CAAE;aAAtBA,YAAAA;IAAuB;AAe7C"}